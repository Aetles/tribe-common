jQuery(document).ready(function(a){function f(){a(".tribe-events-day-time-slot").length&&(a(".tribe-events-day-time-slot").find(".vevent:last").addClass("tribe-events-last"),a(".tribe-events-day-time-slot:first").find(".vevent:first").removeClass("tribe-events-first"))}function g(b){"change_view"!=tribe_events_bar_action&&(b.preventDefault(),tribe_ev.state.ajax_running||(b=a("#tribe-bar-date").val(),tribe_ev.state.popping=!1,b.length?(tribe_ev.state.date=a("#tribe-bar-date").val(),tribe_ev.data.cur_url=
c+tribe_ev.state.date+"/"):(tribe_ev.state.date=tribe_ev.data.cur_date,tribe_ev.data.cur_url=c+tribe_ev.data.cur_date+"/"),tribe_ev.fn.pre_ajax(function(){d()})))}function d(){tribe_ev.fn.spin_show();tribe_ev.state.pushcount=0;tribe_ev.state.ajax_running=!0;if(!tribe_ev.state.popping&&(tribe_ev.state.url_params="",tribe_ev.state.params={action:"tribe_event_day",eventDate:tribe_ev.state.date},tribe_ev.state.url_params={action:"tribe_event_day"},tribe_ev.state.category&&(tribe_ev.state.params.tribe_event_category=
tribe_ev.state.category),a(tribe_ev.events).trigger("tribe_ev_serializeBar"),tribe_ev.state.params=a.param(tribe_ev.state.params),tribe_ev.state.url_params=a.param(tribe_ev.state.url_params),a(tribe_ev.events).trigger("tribe_ev_collectParams"),tribe_ev.state.pushstate=!0,tribe_ev.state.do_string=!1,0<tribe_ev.state.pushcount||tribe_ev.state.filters))tribe_ev.state.pushstate=!1,tribe_ev.state.do_string=!0;tribe_ev.tests.pushstate&&!tribe_ev.state.filter_cats?(a(tribe_ev.events).trigger("tribe_ev_ajaxStart").trigger("tribe_ev_dayView_AjaxStart"),
a("#tribe-events-header").tribe_spin(),a.post(TribeCalendar.ajaxurl,tribe_ev.state.params,function(b){tribe_ev.state.initial_load=!1;tribe_ev.fn.enable_inputs("#tribe_events_filters_form","input, select");b.success&&(tribe_ev.state.ajax_running=!1,tribe_ev.data.ajax_response={total_count:parseInt(b.total_count),view:b.view,max_pages:"",tribe_paged:"",timestamp:(new Date).getTime()},a("#tribe-events-content").replaceWith(b.html),0===b.total_count&&a("#tribe-events-header .tribe-events-sub-nav").empty(),
a(".tribe-events-promo").next(".tribe-events-promo").remove(),a("#tribe-events-content").next(".tribe-clear").remove(),b=a("#tribe-events-header").attr("data-title"),a(document).attr("title",b),tribe_ev.state.do_string&&(tribe_ev.data.cur_url=tribe_ev.data.cur_url+"?"+tribe_ev.state.url_params,history.pushState({tribe_date:tribe_ev.state.date,tribe_params:tribe_ev.state.params},b,tribe_ev.data.cur_url)),tribe_ev.state.pushstate&&history.pushState({tribe_date:tribe_ev.state.date,tribe_params:tribe_ev.state.params},
b,tribe_ev.data.cur_url),f(),a(tribe_ev.events).trigger("tribe_ev_ajaxSuccess").trigger("tribe_ev_dayView_AjaxSuccess"))})):window.location=tribe_ev.state.do_string?tribe_ev.data.cur_url+"?"+tribe_ev.state.url_params:tribe_ev.data.cur_url}var c=tribe_ev.state.filter_cats?a("#tribe-events-header").attr("data-baseurl").slice(0,-11):a("#tribe-events-header .tribe-events-nav-next a").attr("href").slice(0,-11);tribe_ev.state.date=a("#tribe-events-header").attr("data-date");f();if(tribe_ev.tests.pushstate&&
!tribe_ev.tests.map_view()){var e="action=tribe_event_day&eventDate="+tribe_ev.state.date;tribe_ev.data.params.length&&(e=e+"&"+tribe_ev.data.params);history.replaceState({tribe_params:e,tribe_url_params:tribe_ev.data.params},"",location.href);a(window).on("popstate",function(a){if(a=a.originalEvent.state)tribe_ev.state.do_string=!1,tribe_ev.state.pushstate=!1,tribe_ev.state.popping=!0,tribe_ev.state.params=a.tribe_params,tribe_ev.fn.pre_ajax(function(){d()}),tribe_ev.fn.set_form(tribe_ev.state.params)})}a("#tribe-events").on("click",
".tribe-events-nav-previous a, .tribe-events-nav-next a",function(b){b.preventDefault();tribe_ev.state.ajax_running||(b=a(this),tribe_ev.state.popping=!1,tribe_ev.state.date=b.attr("data-day"),tribe_ev.data.cur_url=tribe_ev.state.filter_cats?c+tribe_ev.state.date+"/":b.attr("href"),tribe_ev.fn.update_picker(tribe_ev.state.date),tribe_ev.fn.pre_ajax(function(){d()}))});tribe_ev.fn.snap("#tribe-events-bar","#tribe-events","#tribe-events-footer .tribe-events-nav-previous a, #tribe-events-footer .tribe-events-nav-next a");
a("form#tribe-bar-form").on("submit",function(a){g(a)});if(tribe_ev.tests.live_ajax()&&tribe_ev.tests.pushstate)a("#tribe-bar-date").on("changeDate",function(b){tribe_ev.tests.reset_on()||(tribe_ev.state.popping=!1,tribe_ev.state.date=a(this).val(),tribe_ev.data.cur_url=c+tribe_ev.state.date+"/",tribe_ev.fn.pre_ajax(function(){d()}))});a(tribe_ev.events).on("tribe_ev_runAjax",function(){d()});a(tribe_ev.events).on("tribe_ev_updatingRecurrence",function(){tribe_ev.data.cur_url=tribe_ev.state.filter_cats?
c+tribe_ev.state.date+"/":a("#tribe-events-header").attr("data-baseurl");tribe_ev.state.popping=!1})});
