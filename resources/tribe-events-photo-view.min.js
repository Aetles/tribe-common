jQuery(document).ready(function(b){function h(){b(".photo-loader").hide();b("#tribe-events-photo-events").removeClass("photo-hidden").animate({opacity:"1"},{duration:600})}function e(a){if(jQuery().isotope){var f=!1,c=0,d=0;a.imagesLoaded(function(){a.isotope({transformsEnabled:!1,containerStyle:{position:"relative",overflow:"visible"}},h())});a.resize(function(){d=a.width();645>d?a.addClass("photo-two-col"):a.removeClass("photo-two-col");f&&d!==c&&a.isotope("reLayout");f=!0;c=d})}else b("#tribe-events-photo-events").removeClass("photo-hidden").css("opacity",
"1")}function g(b){"change_view"!=tribe_events_bar_action&&(b.preventDefault(),tribe_ev.state.ajax_running||(tribe_ev.state.paged=1,tribe_ev.state.popping=!1,tribe_ev.fn.pre_ajax(function(){d()})))}function d(){b("#tribe-events-content").tribe_spin();b(".photo-loader").show();b("#tribe-events-photo-events").addClass("photo-hidden");if(!tribe_ev.state.popping){tribe_ev.state.ajax_running=!0;tribe_ev.state.filter_cats&&(tribe_ev.data.cur_url=b("#tribe-events-header").attr("data-baseurl"));var a=b("#tribe-events-list-hash").val();
tribe_ev.state.params={action:"tribe_photo",tribe_paged:tribe_ev.state.paged,tribe_event_display:tribe_ev.state.view};tribe_ev.state.url_params={action:"tribe_photo",tribe_paged:tribe_ev.state.paged,tribe_event_display:tribe_ev.state.view};a.length&&(tribe_ev.state.params.hash=a);tribe_ev.state.category&&(tribe_ev.state.params.tribe_event_category=tribe_ev.state.category);b(tribe_ev.events).trigger("tribe_ev_serializeBar");tribe_ev.state.params=b.param(tribe_ev.state.params);tribe_ev.state.url_params=
b.param(tribe_ev.state.url_params);b(tribe_ev.events).trigger("tribe_ev_collectParams");tribe_ev.state.pushstate=!1;tribe_ev.state.do_string=!0}tribe_ev.tests.pushstate&&!tribe_ev.state.filter_cats?(b(tribe_ev.events).trigger("tribe_ev_ajaxStart").trigger("tribe_ev_photoView_AjaxStart"),b.post(TribePhoto.ajaxurl,tribe_ev.state.params,function(a){tribe_ev.state.initial_load=!1;tribe_ev.fn.enable_inputs("#tribe_events_filters_form","input, select");a.success&&(tribe_ev.state.ajax_running=!1,tribe_ev.data.ajax_response=
{total_count:parseInt(a.total_count),view:a.view,max_pages:a.max_pages,tribe_paged:a.tribe_paged,timestamp:(new Date).getTime()},b("#tribe-events-list-hash").val(a.hash),b("#tribe-events-content").replaceWith(a.html),b("#tribe-events-content").prev("#tribe-events-list-hash").remove(),b(".tribe-events-promo").next(".tribe-events-promo").remove(),"photo"===a.view?a.max_pages==tribe_ev.state.paged?b(".tribe-events-nav-next").hide():b(".tribe-events-nav-next").show():a.max_pages==tribe_ev.state.paged?
b(".tribe-events-nav-previous").hide():b(".tribe-events-nav-previous").show(),tribe_ev.state.do_string&&history.pushState({tribe_params:tribe_ev.state.params,tribe_url_params:tribe_ev.state.url_params},"",tribe_ev.data.cur_url+"?"+tribe_ev.state.url_params),tribe_ev.state.pushstate&&history.pushState({tribe_params:tribe_ev.state.params,tribe_url_params:tribe_ev.state.url_params},"",tribe_ev.data.cur_url),e(b("#tribe-events-photo-events")),b(tribe_ev.events).trigger("tribe_ev_ajaxSuccess").trigger("tribe_ev_photoView_AjaxSuccess"))})):
window.location=tribe_ev.state.do_string?tribe_ev.data.cur_url+"?"+tribe_ev.state.url_params:tribe_ev.data.cur_url}var c=tribe_ev.fn.get_url_param("tribe_paged");tribe_ev.state.view="photo";c&&(tribe_ev.state.paged=c);c=b("#tribe-events-photo-events");e(c);643>c.width()&&c.addClass("photo-two-col");tribe_ev.tests.pushstate&&!tribe_ev.tests.map_view()&&(c="action=tribe_photo&tribe_paged="+tribe_ev.state.paged,tribe_ev.data.params.length&&(c=c+"&"+tribe_ev.data.params),history.replaceState({tribe_params:c,
tribe_url_params:tribe_ev.data.params},"",location.href),b(window).on("popstate",function(a){if(a=a.originalEvent.state)tribe_ev.state.do_string=!1,tribe_ev.state.pushstate=!1,tribe_ev.state.popping=!0,tribe_ev.state.params=a.tribe_params,tribe_ev.state.url_params=a.tribe_url_params,tribe_ev.fn.pre_ajax(function(){d()}),tribe_ev.fn.set_form(tribe_ev.state.params)}));b("#tribe-events").on("click","li.tribe-events-nav-next a",function(a){a.preventDefault();tribe_ev.state.ajax_running||("past"===tribe_ev.state.view?
1===tribe_ev.state.paged?tribe_ev.state.view="photo":tribe_ev.state.paged--:tribe_ev.state.paged++,tribe_ev.state.popping=!1,tribe_ev.fn.pre_ajax(function(){d()}))}).on("click","li.tribe-events-nav-previous a",function(a){a.preventDefault();tribe_ev.state.ajax_running||("photo"===tribe_ev.state.view?1===tribe_ev.state.paged?tribe_ev.state.view="past":tribe_ev.state.paged--:tribe_ev.state.paged++,tribe_ev.state.popping=!1,tribe_ev.fn.pre_ajax(function(){d()}))});if(tribe_ev.tests.live_ajax()&&tribe_ev.tests.pushstate)b("#tribe-bar-date").on("changeDate",
function(a){tribe_ev.tests.reset_on()||g(a)});b(tribe_ev.events).on("tribe_ev_updatingRecurrence",function(){tribe_ev.state.popping=!1});b("#tribe-bar-form").on("submit",function(a){"change_view"!=tribe_events_bar_action&&g(a)});tribe_ev.fn.snap("#tribe-events-content","#tribe-events-content","#tribe-events-footer .tribe-events-nav-previous a, #tribe-events-footer .tribe-events-nav-next a");b(tribe_ev.events).on("tribe_ev_runAjax",function(){d()})});
