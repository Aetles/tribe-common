(function(b,d,f,e,a,g,h){h&&(b().isotope||debug.warn("TEC Debug: vendor bootstrapDatepicker was not loaded before its dependant file tribe-photo-view.js"));b(document).ready(function(){function s(){b(".photo-loader").hide();b("#tribe-events-photo-events").removeClass("photo-hidden").animate({opacity:"1"},{duration:600})}function m(a){n=a.width();645>n?a.addClass("photo-two-col"):a.removeClass("photo-two-col")}function p(a){b().isotope?(a.imagesLoaded(function(){a.isotope({transformsEnabled:!1,containerStyle:{position:"relative",
overflow:"visible"}},s());h&&debug.info("TEC Debug: imagesLoaded setup isotope on photo view.")}),m(a),a.resize(function(){m(a);clearTimeout(q);q=setTimeout(function(){a.isotope("reLayout")},400)})):b("#tribe-events-photo-events").removeClass("photo-hidden").css("opacity","1")}function r(b){"change_view"!=tribe_events_bar_action&&(b.preventDefault(),a.ajax_running||(a.paged=1,a.view="photo",a.popping=!1,e.pre_ajax(function(){l()})))}function l(){b("#tribe-events-header").tribe_spin();b(".photo-loader").show();
b("#tribe-events-photo-events").addClass("photo-hidden");if(!a.popping){a.ajax_running=!0;a.filter_cats&&(d.cur_url=b("#tribe-events-header").attr("data-baseurl"));var c=b("#tribe-events-list-hash").val();a.params={action:"tribe_photo",tribe_paged:a.paged,tribe_event_display:a.view};a.url_params={action:"tribe_photo",tribe_paged:a.paged,tribe_event_display:a.view};c.length&&(a.params.hash=c);a.category&&(a.params.tribe_event_category=a.category);b(f).trigger("tribe_ev_serializeBar");a.params=b.param(a.params);
a.url_params=b.param(a.url_params);b(f).trigger("tribe_ev_collectParams");a.pushstate=!1;a.do_string=!0}g.pushstate&&!a.filter_cats?(h&&debug.time("Photo View Ajax Timer"),b(f).trigger("tribe_ev_ajaxStart").trigger("tribe_ev_photoView_AjaxStart"),b.post(TribePhoto.ajaxurl,a.params,function(c){a.initial_load=!1;e.enable_inputs("#tribe_events_filters_form","input, select");c.success&&(a.ajax_running=!1,d.ajax_response={total_count:parseInt(c.total_count),view:c.view,max_pages:c.max_pages,tribe_paged:c.tribe_paged,
timestamp:(new Date).getTime()},b("#tribe-events-list-hash").val(c.hash),b("#tribe-events-content").replaceWith(c.html),b("#tribe-events-content").prev("#tribe-events-list-hash").remove(),b(".tribe-events-promo").next(".tribe-events-promo").remove(),"photo"===c.view?c.max_pages==a.paged?b(".tribe-events-nav-next").hide():b(".tribe-events-nav-next").show():c.max_pages==a.paged?b(".tribe-events-nav-previous").hide():b(".tribe-events-nav-previous").show(),a.do_string&&history.pushState({tribe_params:a.params,
tribe_url_params:a.url_params},"",d.cur_url+"?"+a.url_params),a.pushstate&&history.pushState({tribe_params:a.params,tribe_url_params:a.url_params},"",d.cur_url),p(b("#tribe-events-photo-events")),b(f).trigger("tribe_ev_ajaxSuccess").trigger("tribe_ev_photoView_AjaxSuccess"),h&&debug.timeEnd("Photo View Ajax Timer"))})):window.location=a.do_string?d.cur_url+"?"+a.url_params:d.cur_url}var k=e.get_url_param("tribe_paged"),t=b("#tribe-events-photo-events"),n=0,q;a.view="photo";k&&(a.paged=k);p(t);g.pushstate&&
!g.map_view()&&(k="action=tribe_photo&tribe_paged="+a.paged,d.params.length&&(k=k+"&"+d.params),history.replaceState({tribe_params:k,tribe_url_params:d.params},"",location.href),b(window).on("popstate",function(b){if(b=b.originalEvent.state)a.do_string=!1,a.pushstate=!1,a.popping=!0,a.params=b.tribe_params,a.url_params=b.tribe_url_params,e.pre_ajax(function(){l()}),e.set_form(a.params)}));b("#tribe-events").on("click","li.tribe-events-nav-next a",function(b){b.preventDefault();a.ajax_running||("past"===
a.view?1===a.paged?a.view="photo":a.paged--:a.paged++,a.popping=!1,e.pre_ajax(function(){l()}))}).on("click","li.tribe-events-nav-previous a",function(b){b.preventDefault();a.ajax_running||("photo"===a.view?1===a.paged?a.view="past":a.paged--:a.paged++,a.popping=!1,e.pre_ajax(function(){l()}))});if(g.live_ajax()&&g.pushstate)b("#tribe-bar-date").on("changeDate",function(a){g.reset_on()||r(a)});b(f).on("tribe_ev_updatingRecurrence",function(){a.popping=!1});b("#tribe-bar-form").on("submit",function(a){"change_view"!=
tribe_events_bar_action&&r(a)});e.snap("#tribe-events-content","#tribe-events-content","#tribe-events-footer .tribe-events-nav-previous a, #tribe-events-footer .tribe-events-nav-next a");b(f).on("tribe_ev_runAjax",function(){l()});h&&debug.info("tribe-events-photo-view.js successfully loaded");a.view&&h&&debug.timeEnd("Tribe JS Init Timer")})})(jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_debug);
