(function(c,d,k,f,b,g){c(document).ready(function(){function p(){var a=c(".time-row-8AM");c(".tribe-week-grid-wrapper").slimScroll({height:"500px",railVisible:!0,alwaysVisible:!0,start:a})}function s(){c(".tribe-event-placeholder").each(function(){var a=c(this).attr("data-event-id"),a=parseInt(c("#tribe-events-event-"+a).outerHeight());c(this).height(a)})}function t(a){a.each(function(){var a=c(this),b=a.next(),d={left:"0",width:"65%"},u={right:"0",width:"65%"};if(b.length){var e=b.offset(),f=[e.left,
e.left+b.outerWidth()],e=[e.top,e.top+b.outerHeight()],h=a.offset(),g=[h.left,h.left+a.outerWidth()],h=[h.top,h.top+a.outerHeight()];f[0]<g[1]&&(f[1]>g[0]&&e[0]<h[1]&&e[1]>h[0])&&(a.is(".overlap-right")?b.css(d).addClass("overlap-left"):(a.is(".overlap-left")||a.css(d),b.css(u).addClass("overlap-right")))}})}function v(){var a=c(".tribe-grid-body .tribe-grid-content-wrap .column > div[id*='tribe-events-event-']"),b=c(".tribe-week-grid-inner-wrap").height();a.each(function(){var a=c(this),d=a.attr("data-hour"),
f=a.attr("data-duration"),e=a.attr("data-min"),d=c('.tribe-week-grid-block[data-hour="'+d+'"]'),d=d.offset().top-d.parent().offset().top-d.parent().scrollTop(),d=parseInt(Math.round(d))+parseInt(e),e=parseInt(b)-parseInt(f)-parseInt(d);0>e&&(f=f+e-14);a.css({height:f+"px",top:d+"px"}).find("a").css({height:f-16+"px"})});c("div[id^='tribe-events-event-']").css({visibility:"visible",opacity:"0"}).delay(500).animate({opacity:"1"},{duration:250});t(a);a=c(".tribe-grid-header .tribe-grid-content-wrap .column").height();
c(".tribe-grid-header .column").height(a);a=c(".tribe-grid-allday .tribe-grid-content-wrap").height();c(".tribe-grid-allday .column").height(a);a=c(".tribe-grid-body").height();c(".tribe-grid-body .tribe-grid-content-wrap .column").height(a)}function m(a,b){s();for(var d=c(".tribe-grid-allday"),f=d.find(".vevent"),g=parseInt(c(".tribe-grid-content-wrap .column").width())-8,e=1;8>e;e++)f.hasClass("tribe-dayspan"+e)&&d.find(".tribe-dayspan"+e).children("div").css("width",g*e+(4*(2*e-2)+(e-1))+"px");
c(".tribe-grid-body .column:eq(5), .tribe-grid-body .column:eq(6), .tribe-grid-body .column:eq(7)").addClass("tribe-events-right");b&&c(".tribe-grid-content-wrap .column").css("height","auto");v();a&&"function"===typeof a&&a()}function q(a){"change_view"!=tribe_events_bar_action&&(a.preventDefault(),b.ajax_running||(a=c("#tribe-bar-date").val(),b.popping=!1,a.length?(b.date=c("#tribe-bar-date").val(),d.cur_url=d.base_url+b.date+"/"):(b.date=d.cur_date,d.cur_url=d.base_url+d.cur_date+"/"),f.pre_ajax(function(){n()})))}
function n(){c("#tribe-events-header").tribe_spin();b.pushcount=0;b.ajax_running=!0;if(!b.popping&&(b.filter_cats&&(d.cur_url=d.base_url),b.params={action:"tribe_week",eventDate:b.date},b.url_params={},b.category&&(b.params.tribe_event_category=b.category),c(k).trigger("tribe_ev_serializeBar"),b.params=c.param(b.params),b.url_params=c.param(b.url_params),c(k).trigger("tribe_ev_collectParams"),b.pushstate=!0,b.do_string=!1,0<b.pushcount||b.filters))b.pushstate=!1,b.do_string=!0;g.pushstate?(c(k).trigger("tribe_ev_ajaxStart").trigger("tribe_ev_weekView_AjaxStart"),
c.post(TribeWeek.ajaxurl,b.params,function(a){b.initial_load=!1;f.enable_inputs("#tribe_events_filters_form","input, select");a.success&&(b.ajax_running=!1,d.ajax_response={total_count:"",view:a.view,max_pages:"",tribe_paged:"",timestamp:(new Date).getTime()},c("#tribe-events-content.tribe-events-week-grid").replaceWith(a.html),a=c("#tribe-events-header").attr("data-title"),c(document).attr("title",a),m(p(),!1),c(".tribe-events-grid").resize(function(){m(!1,!0)}),c("div[id*='tribe-events-event-']").hide().fadeIn("fast"),
b.do_string&&history.pushState({tribe_url_params:b.url_params,tribe_params:b.params},a,d.cur_url+"?"+b.url_params),b.pushstate&&history.pushState({tribe_url_params:b.url_params,tribe_params:b.params},a,d.cur_url),c(k).trigger("tribe_ev_ajaxSuccess").trigger("tribe_ev_weekView_AjaxSuccess"))})):window.location=b.do_string?d.cur_url+"?"+b.url_params:d.cur_url}var w=c("#tribe-events"),l=c("#tribe-events-bar"),r=c("#tribe-events-header");l.addClass("tribe-has-datepicker");b.date=r.attr("data-date");var x=
c("#tribe-bar-date").bootstrapDatepicker({format:"yyyy-mm-dd",showAnim:"fadeIn",onRender:function(a){var b=r.attr("data-startofweek"),d=[0,1,2,3,4,5,6];delete d[b];a=a.getDay();for(i=0;i<d.length;i++)if(-1!=c.inArray(a,d))return"disabled";return""}}).on("changeDate",function(){x.hide()}).data("datepicker");m(p(),!1);c(".tribe-events-grid").resize(function(){m(!1,!0)});g.pushstate&&!g.map_view()&&(l="action=tribe_week&eventDate="+b.date,d.params.length&&(l=l+"&"+d.params),history.replaceState({tribe_params:l,
tribe_url_params:d.params},"",location.href),c(window).on("popstate",function(a){if(a=a.originalEvent.state)b.do_string=!1,b.pushstate=!1,b.popping=!0,b.params=a.tribe_params,b.url_params=a.tribe_url_params,f.pre_ajax(function(){n()}),f.set_form(b.params)}));w.on("click",".tribe-events-sub-nav a",function(a){a.preventDefault();b.ajax_running||(a=c(this),b.popping=!1,b.date=a.attr("data-week"),d.cur_url=a.attr("href"),f.update_picker(b.date),f.pre_ajax(function(){n()}))});c("form#tribe-bar-form").on("submit",
function(a){q(a)});if(g.live_ajax()&&g.pushstate)c("#tribe-bar-date").on("changeDate",function(a){g.reset_on()||q(a)});f.snap("#tribe-events-content","body","#tribe-events-footer .tribe-events-nav-previous a, #tribe-events-footer .tribe-events-nav-next a");c(k).on("tribe_ev_runAjax",function(){n()})})})(jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests);
