!function(e,t){"use strict";t.selector={dropdown:".tribe-dropdown"},e.fn.tribe_dropdowns=function(){return t.dropdown(this),this},t.dropdown=function(a){var r=a.not(".select2-offscreen, .select2-container");return r.each(function(){var a,r=e(this),i={dropdownAutoWidth:!0,dropdownCss:{width:"auto"}},n=["depends","condition","conditionNot","condition-not","conditionNotEmpty","condition-not-empty","conditionEmpty","condition-empty","conditionIsNumeric","condition-is-numeric","conditionIsNotNumeric","condition-is-not-numeric"];if(r.is("select")||(i.id=t.search_id),i.allowClear=!0,r.is("[data-prevent-clear]")&&(i.allowClear=!1),r.is("[data-options]")&&(i.data=r.data("options"),r.is("select")||(i.initSelection=t.setup_initSelection(i,r))),r.is("[data-allow-html]")&&(i.escapeMarkup=function(e){return e}),r.is("[data-hide-search]")&&(i.minimumResultsForSearch=1/0),r.is("[data-freeform]")&&(i.createSearchChoice=function(e,t){if(e.match(i.regexToken)&&(!r.is("[data-int]")||r.is("[data-int]")&&e.match(/\d+/))){var a={id:e,text:e,"new":!0};return r.is("[data-create-choice-template]")&&(a.text=_.template(r.data("createChoiceTemplate"))({term:e})),a}}),"tribe-ea-field-origin"===r.attr("id")&&(i.formatResult=i.upsellFormatter,i.formatSelection=i.upsellFormatter,i.escapeMarkup=function(e){return e}),r.is("[multiple]")&&(i.multiple=!0,_.isArray(r.data("separator"))?i.tokenSeparators=r.data("separator"):i.tokenSeparators=[r.data("separator")],i.separator=r.data("separator"),i.regexSeparatorElements=["^("],i.regexSplitElements=["(?:"],e.each(i.tokenSeparators,function(e,t){i.regexSeparatorElements.push("[^"+t+"]+"),i.regexSplitElements.push("["+t+"]")}),i.regexSeparatorElements.push(")$"),i.regexSplitElements.push(")"),i.regexSeparatorString=i.regexSeparatorElements.join(""),i.regexSplitString=i.regexSplitElements.join(""),i.regexToken=new RegExp(i.regexSeparatorString,"ig"),i.regexSplit=new RegExp(i.regexSplitString,"ig")),i.matcher=function(e,a){var r=0==a.toUpperCase().indexOf(e.toUpperCase());if(!r&&"undefined"!=typeof i.tags){var n=_.where(i.tags,{text:a});if(i.tags.length>0&&_.isObject(n)){var o=t.search_id(n[0]);r=0==o.toUpperCase().indexOf(e.toUpperCase())}}return r},r.is("[data-tags]")&&(i.tags=r.data("tags"),i.initSelection=t.setup_initSelection(i,r),i.createSearchChoice=function(e,t){return e.match(i.regexToken)?{id:e,text:e}:void 0},0===i.tags.length&&(i.formatNoMatches=function(){return r.attr("placeholder")})),r.is("[data-source]")){var o=r.data("source");i.data={results:[]},i.escapeMarkup=function(e){return e},i.ajax={dataType:"json",type:"POST",url:window.ajaxurl,results:function(e){return e.data}},i.ajax.data=function(e,t){return{action:"tribe_aggregator_dropdown_"+o}}}a=r.select2(i).select2("container"),n.length>0&&n.map(function(e){var t="data-"+e,a=r.attr(t);a&&this.attr(t,a)},a)}).on("select2-open",function(t){var a=e(this);a.is("[data-search-placeholder]")&&e(".select2-input").attr("placeholder",a.data("searchPlaceholder"))}).on("select2-close",function(t){e(this);e(".select2-input").attr("placeholder",null)}).on("change",function(t){var a=e(this),r=e(this).data("value");a.is("[multiple]")&&a.is("[data-source]")&&(t.added?_.isArray(r)?r.push(t.added):r=[t.added]:r=_.isArray(r)?_.without(r,t.removed):[],a.data("value",r).attr("data-value",JSON.stringify(r)))}),r},t.search_id=function(e){var t=void 0;return"undefined"!=typeof e.id?t=e.id:"undefined"!=typeof e.ID?t=e.ID:"undefined"!=typeof e.value&&(t=e.value),void 0===e?void 0:t},t.setup_initSelection=function(t,a){var r=a.is("[data-multiple]");return function(a,i){var n=[];e(a.val().split(t.regexSplit)).each(function(){var e={id:this,text:this};if(t.data.length>0&&_.isObject(t.data[0])){var a=_.where(t.data,{text:this.valueOf()});a.length>0?e=a[0]:(a=_.where(t.data,{id:parseInt(this.valueOf(),10)}),a.length>0&&(e=a[0]))}r?n.push(e):i(e)}),r&&i(n)}},e(function(){e(t.selector.dropdown).tribe_dropdowns()})}(jQuery,{});