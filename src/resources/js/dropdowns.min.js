!function(e,t){t.selector={dropdown:"tribe-dropdown"},e.fn.tribe_dropdowns=function(){return t.dropdown(this),this},t.dropdown=function(r){var a=r.not(".select2-offscreen, .select2-container");return a.each(function(){var r=e(this),a={dropdownAutoWidth:!0,dropdownCss:{"min-width":"5rem"}};if(r.is("select")||(a.id=t.search_id),a.allowClear=!0,r.is("[data-prevent-clear]")&&(a.allowClear=!1),r.is("[data-options]")&&(a.data=r.data("options")),r.is("[data-hide-search]")&&(a.minimumResultsForSearch=1/0),r.is("[data-freeform]")&&(a.createSearchChoice=function(e,t){if(e.match(a.regexToken))return{id:e,text:e}}),"tribe-ea-field-origin"===r.attr("id")&&(a.formatResult=a.upsellFormatter,a.formatSelection=a.upsellFormatter,a.escapeMarkup=function(e){return e}),r.is("[multiple]")&&(a.multiple=!0,_.isArray(r.data("separator"))?a.tokenSeparators=r.data("separator"):a.tokenSeparators=[r.data("separator")],a.separator=r.data("separator"),a.regexSeparatorElements=["^("],a.regexSplitElements=["(?:"],e.each(a.tokenSeparators,function(e,t){a.regexSeparatorElements.push("[^"+t+"]+"),a.regexSplitElements.push("["+t+"]")}),a.regexSeparatorElements.push(")$"),a.regexSplitElements.push(")"),a.regexSeparatorString=a.regexSeparatorElements.join(""),a.regexSplitString=a.regexSplitElements.join(""),a.regexToken=new RegExp(a.regexSeparatorString,"ig"),a.regexSplit=new RegExp(a.regexSplitString,"ig")),a.matcher=function(e,r){var n=0==r.toUpperCase().indexOf(e.toUpperCase());if(!n&&"undefined"!=typeof a.tags){var i=_.where(a.tags,{text:r});if(a.tags.length>0&&_.isObject(i)){var o=t.search_id(i[0]);n=0==o.toUpperCase().indexOf(e.toUpperCase())}}return n},r.is("[data-tags]")&&(a.tags=r.data("options"),a.initSelection=function(t,r){var n=[];e(t.val().split(a.regexSplit)).each(function(){var e={id:this,text:this};if(a.tags.length>0&&_.isObject(a.tags[0])){var t=_.where(a.tags,{value:this});t.length>0&&(e=t[0],e={id:e.value,text:e.text})}n.push(e)}),r(n)},a.createSearchChoice=function(e,t){if(e.match(a.regexToken))return{id:e,text:e}},0===a.tags.length&&(a.formatNoMatches=function(){return r.attr("placeholder")})),r.is("[data-source]")){var n=r.data("source");a.data={results:[]},a.escapeMarkup=function(e){return e},a.ajax={dataType:"json",type:"POST",url:window.ajaxurl,results:function(e){return e.data}},a.ajax.data=function(e,t){return{action:"tribe_aggregator_dropdown_"+n}}}r.select2(a)}).on("change",function(t){var r=e(this),a=e(this).data("value");r.is("[multiple]")&&r.is("[data-source]")&&(t.added?_.isArray(a)?a.push(t.added):a=[t.added]:a=_.isArray(a)?_.without(a,t.removed):[],r.data("value",a).attr("data-value",JSON.stringify(a)))}),a},t.search_id=function(e){var t=null;return"undefined"!=typeof e.id?t=e.id:"undefined"!=typeof e.ID?t=e.ID:"undefined"!=typeof e.value&&(t=e.value),void 0==e?null:t},e(function(){e(t.selector.dropdown).tribe_dropdowns()})}(jQuery,{});