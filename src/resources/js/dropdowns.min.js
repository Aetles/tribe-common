!function(e,t){"use strict";t.selector={dropdown:"tribe-dropdown"},e.fn.tribe_dropdowns=function(){return t.dropdown(this),this},t.dropdown=function(a){var r=a.not(".select2-offscreen, .select2-container");return r.each(function(){var a=e(this),r={dropdownAutoWidth:!0,dropdownCss:{"min-width":"5rem"}};if(a.is("select")||(r.id=t.search_id),r.allowClear=!0,a.is("[data-prevent-clear]")&&(r.allowClear=!1),a.is("[data-options]")&&(r.data=a.data("options"),a.is("select")||(r.initSelection=t.setup_initSelection(r,a))),a.is("[data-hide-search]")&&(r.minimumResultsForSearch=1/0),a.is("[data-freeform]")&&(r.createSearchChoice=function(e,t){if(e.match(r.regexToken)&&(!a.is("[data-int]")||a.is("[data-int]")&&e.match(/\d+/)))return{id:e,text:e}}),"tribe-ea-field-origin"===a.attr("id")&&(r.formatResult=r.upsellFormatter,r.formatSelection=r.upsellFormatter,r.escapeMarkup=function(e){return e}),a.is("[multiple]")&&(r.multiple=!0,_.isArray(a.data("separator"))?r.tokenSeparators=a.data("separator"):r.tokenSeparators=[a.data("separator")],r.separator=a.data("separator"),r.regexSeparatorElements=["^("],r.regexSplitElements=["(?:"],e.each(r.tokenSeparators,function(e,t){r.regexSeparatorElements.push("[^"+t+"]+"),r.regexSplitElements.push("["+t+"]")}),r.regexSeparatorElements.push(")$"),r.regexSplitElements.push(")"),r.regexSeparatorString=r.regexSeparatorElements.join(""),r.regexSplitString=r.regexSplitElements.join(""),r.regexToken=new RegExp(r.regexSeparatorString,"ig"),r.regexSplit=new RegExp(r.regexSplitString,"ig")),r.matcher=function(e,a){var i=0==a.toUpperCase().indexOf(e.toUpperCase());if(!i&&"undefined"!=typeof r.tags){var n=_.where(r.tags,{text:a});if(r.tags.length>0&&_.isObject(n)){var o=t.search_id(n[0]);i=0==o.toUpperCase().indexOf(e.toUpperCase())}}return i},a.is("[data-tags]")&&(r.tags=a.data("tags"),r.initSelection=t.setup_initSelection(r,a),r.createSearchChoice=function(e,t){if(e.match(r.regexToken))return{id:e,text:e}},0===r.tags.length&&(r.formatNoMatches=function(){return a.attr("placeholder")})),a.is("[data-source]")){var i=a.data("source");r.data={results:[]},r.escapeMarkup=function(e){return e},r.ajax={dataType:"json",type:"POST",url:window.ajaxurl,results:function(e){return e.data}},r.ajax.data=function(e,t){return{action:"tribe_aggregator_dropdown_"+i}}}a.select2(r)}).on("change",function(t){var a=e(this),r=e(this).data("value");a.is("[multiple]")&&a.is("[data-source]")&&(t.added?_.isArray(r)?r.push(t.added):r=[t.added]:r=_.isArray(r)?_.without(r,t.removed):[],a.data("value",r).attr("data-value",JSON.stringify(r)))}),r},t.search_id=function(e){var t=void 0;return"undefined"!=typeof e.id?t=e.id:"undefined"!=typeof e.ID?t=e.ID:"undefined"!=typeof e.value&&(t=e.value),void 0===e?void 0:t},t.setup_initSelection=function(t,a){var r=a.is("[data-multiple]");return function(a,i){var n=[];e(a.val().split(t.regexSplit)).each(function(){var e={id:this,text:this};if(t.data.length>0&&_.isObject(t.data[0])){var a=_.where(t.data,{text:this.valueOf()});a.length>0&&(e=a[0])}r?n.push(e):i(e)}),r&&i(n)}},e(function(){e(t.selector.dropdown).tribe_dropdowns()})}(jQuery,{});