jQuery(document).ready(function(a){function b(){a("#recurrence-changed-row").show()}function c(){a("#publishing-action .button-primary-disabled").removeClass("button-primary-disabled"),a("#publishing-action .spinner").hide()}function d(){return a('[name="recurrence[custom-interval]"]').val()!=parseInt(a('[name="recurrence[custom-interval]"]').val())&&"Custom"==a('[name="recurrence[type]"] option:selected').val()?!1:!0}function e(){return"None"!=a('[name="recurrence[type]"]').val()&&"On"==a('[name="recurrence[end-type]"] option:selected').val()?a('[name="recurrence[end]"]').val()&&!a('[name="recurrence[end]"]').hasClass("placeholder"):!0}function f(){var b=a('[name="recurrence[type]"]').val(),c=a('[name="recurrence[end]"]').val(),d=a('[name="recurrence[end-type]"]').val(),e=parseInt(a('[name="recurrence[end-count]"]').val()),f=a('[name="recurrence[custom-type]"]').val(),g=a('[name="recurrence[custom-interval]"]').val(),h=a("#recurrence-interval-type").text(),i=a('[name="recurrence[custom-week-day][]"]:checked').map(function(){return a(this).val()}).get(),j=a('[name="recurrence[custom-month-number]"]').val(),k=a('[name="recurrence[custom-month-day]"]').val(),l=a('[name="recurrence[custom-year-month][]"]:checked').map(function(){return a(this).val()}).get(),m=(a('[name="recurrence[custom-year-filter]"]').val(),a('[name="recurrence[custom-year-month-number]"]').val()),n=a('[name="recurrence[custom-year-month-day]"]').val(),o=new Array("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"),p=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),q=new Array("last","first","second","third","fourth"),r="Your event first occurs on "+a("#EventStartDate").val(),s=a("#EventEndDate").val().split("-");s=new Date(s[0],s[1]-1,s[2]);var t=a("#EventStartDate").val().split("-");t=new Date(t[0],t[1]-1,t[2]);var u=t,v=s;if(["Daily","Weekly","Monthly","Yearly"].indexOf(f)>=0&&(h=g>1?"events":"event"),"After"==d)if("Every Day"==b)u.setDate(t.getDate()+e-1),v.setDate(s.getDate()+e-1);else if("Every Week"==b)u.setDate(t.getDate()+7*(e-1)),v.setDate(s.getDate()+7*(e-1));else if("Every Month"==b)u.setMonth(t.getMonth()+e-1),v.setMonth(s.getMonth()+e-1);else if("Every Year"==b)u.setYear(t.getFullYear()+e-1),v.setYear(s.getFullYear()+e-1);else if("Custom"==b)if("Daily"==f)u.setDate(t.getDate()+(e-1)*g),v.setDate(s.getDate()+(e-1)*g);else if("Weekly"==f&&e>1){for(var w=new Array("8"),x=t.getDay(),y=0,z=0;z<i.length;z++)if(1==i.length||i[z]-x>0&&i[z]-x<w[0])for(var A=0,B=z;A<i.length;A++,B++)w[A]=i[B],B+1==i.length&&B>0&&(B=-1);var C=e%i.length-1;"-1"==C&&(C=i.length-1),x+1!=w[i.length-1]&&(y=1,C--,"-1"==C&&(C=i.length-1));Math.ceil(e/i.length-y/i.length)-1}if("Custom"!=b)"After"==d?r+=" and repeats "+b.toLowerCase()+" for "+e+" "+a("#occurence-count-text").text():"On"==d&&""!=c&&(r+=" and repeats "+b.toLowerCase()+" until "+c),r+=".";else{if(r+=" and repeats "+f.toLowerCase(),r+=g>1?" every "+g+" "+h.toLowerCase():" every "+h.toLowerCase(),"Weekly"==f&&i&&i.length>0){r+=" on ";for(var z=0;z<i.length;z++)0==z?r+=o[i[z]-1]:z!=i.length-1&&z>0?r+=", "+o[i[z]-1]:(i.length>2&&(r+=","),r+=" and "+o[i[z]-1])}if("Monthly"==f&&(r+=" on",isNaN(j)?(r+=" the "+j.toLowerCase(),r+="-1"==k?" day":" "+o[k-1]):r+=" day "+j),"Yearly"==f){r+=" in ";for(var z=0;z<l.length;z++)0==z?r+=p[l[z]-1]:z!=l.length-1&&z>0?r+=", "+p[l[z]-1]:(l.length>2&&(r+=","),r+=" and "+p[l[z]-1]);a('[name="recurrence[custom-year-filter]"]').is(":checked")&&(r+=" on the ",r+="-1"==m?q[0]:q[m],r+=" "+o[n-1])}"After"==d?r+=" for "+e+" occurrences":"On"==d&&""!=c&&(r+=" until "+c),r+="."}"After"==d&&"Custom"!=b&&(r+=" The final occurrence begins",r+=v.getTime()===u.getTime()?" and ends on "+v.getFullYear()+"-"+(v.getMonth()+1)+"-"+v.getDate()+".":" on "+u.getFullYear()+"-"+(u.getMonth()+1)+"-"+u.getDate()+" and ends on "+v.getFullYear()+"-"+(v.getMonth()+1)+"-"+v.getDate()+"."),"None"==b&&a(".recurrence-pattern-description-row").hide(),a("#recurrence-pattern-description").text(r)}function g(a){var b=Date.now(),c=b-t;a.html&&p.html(html),a.progress&&i(a.progress,a.progressText),a["continue"]&&(500>c?setTimeout(h,500-c):h()),a.complete&&(q.replaceWith(TribeEventsProRecurrenceUpdate.completeMsg),p.removeClass("updating").addClass("completed"),setTimeout(j,1e3))}function h(){var b={event:TribeEventsProRecurrenceUpdate.eventID,check:TribeEventsProRecurrenceUpdate.check,action:"tribe_events_pro_recurrence_realtime_update"};a.post(ajaxurl,b,g,"json")}function i(a,b){a=parseInt(a),0>a||a>100||(s.css("width",a+"%"),r.attr("title",b))}function j(){var a={opacity:0,height:"toggle"};p.animate(a,1e3,function(){p.remove()})}function k(){h(),i(TribeEventsProRecurrenceUpdate.progress,TribeEventsProRecurrenceUpdate.progressText)}a('[name="recurrence[type]"]').change(function(){var b=a(this).find("option:selected").val();a(".custom-recurrence-row").hide(),"Custom"==b?(a("#recurrence-end").show(),a(".custom-recurrence-frequency").show(),a('[name="recurrence[custom-type]"]').change()):"None"==b?(a("#recurrence-end").hide(),a(".custom-recurrence-frequency").hide()):(a("#recurrence-end").show(),a(".custom-recurrence-frequency").hide())}),a('[name="recurrence[end-type]"]').change(function(){var b=a(this).find("option:selected").val();"On"==b?(a("#rec-count").hide(),a("#recurrence_end").show()):"Never"==b?a("#rec-count, #recurrence_end").hide():(a("#recurrence_end").hide(),a("#rec-count").show())}),a('[name="recurrence[custom-type]"]').change(function(){a(".custom-recurrence-row").hide();var b=a(this).find("option:selected"),c=b.data("tablerow");a(c).show(),a("#recurrence-interval-type").text(b.data("plural")),a('[name="recurrence[custom-type-text]"]').val(b.data("plural"))}),a("#recurrence_end_count").change(function(){a('[name="recurrence[type]"]').change()}),a('[name="recurrence[type]"]').change(function(){var b=(a(this).find("option:selected"),a("#recurrence_end_count").val());a("#occurence-count-text").text(1==b?a(this).data("single"):a(this).data("plural")),a('[name="recurrence[occurrence-count-text]"]').val(a("#occurence-count-text").text())}),a('[name="recurrence[custom-month-number]"]').change(function(){var b=a(this).find("option:selected"),c=a('[name="recurrence[custom-month-day]"]');isNaN(b.val())?c.show():c.hide()});var l=a('[name="recurrence[end]"]'),m=a('[name="is_recurring"]');"true"==m.val()&&(a(".recurrence-row input, .custom-recurrence-row input,.recurrence-row select, .custom-recurrence-row select").change(b),l.bind("recurrenceEndChanged",b)),l.datepicker("option","onSelect",function(){l.removeClass("placeholder"),a(this).trigger("recurrenceEndChanged")}),a("#event_venue input, #event_venue select").change(function(){var b=a("#saved_venue option:selected");if(0==b.val()){var c=a(this).closest("form"),d=c.find('[name="venue[Address]"]').val(),e=c.find('[name="venue[City]"]').val(),f=c.find('[name="venue[Country]"]').val(),g="US"==c.find('[name="venue[Country]"] option:selected').val()?c.find('[name="venue[State]"]').val():c.find('[name="venue[Province]"]').val(),h=c.find('[name="venue[Zip]"]').val(),i=d+","+e+","+g+","+f+","+h;"function"==typeof codeAddress&&codeAddress(i)}else"function"==typeof codeAddress&&codeAddress(b.data("address"))}),a("#doaction, #doaction2").click(function(b){var c=a(this).attr("id").substr(2);if("edit"==a('select[name="'+c+'"]').val()&&"tribe_events"==a(".post_type_page").val()){b.preventDefault();var d=new Array;a("#bulk-titles div").each(function(){var b=a(this).attr("id"),c=b.replace("ttle",""),e=a("#post-"+c+" .row-title").first().text(),f=a("<div/>").append(a(this).find("a"));a(this).html("").append(f).append(e),d[b]&&a(this).remove(),d[b]=!0})}}),a(".wp-admin.events-cal #post").submit(function(b){d()||(b.preventDefault(),alert(a("#rec-days-error").text()),a("#rec-days-error").show(),c())}),a("body").live("click",".ui-dialog-titlebar .ui-dialog-titlebar-close",function(){c()}),a(".wp-admin.events-cal #post").submit(function(b){e()||(b.preventDefault(),alert(a("#rec-end-error").text()),a("#rec-end-error").show(),c())});var n=function(){f(),o()};a("#recurrence_end, #EventStartDate, #EventEndDate").datepicker("option","onClose",n),a(".recurrence-row, .custom-recurrence-row").on("change",function(b){a(".recurrence-pattern-description-row").is(":visible")||a(".recurrence-pattern-description-row").show(),f()});var o=function(){var b=a("#EventStartDate").val();""!=b&&a("#recurrence_end").attr("placeholder",b).datepicker("option","minDate",b)};if(o(),a('input[name="post[]"]').click(function(b){var c=a(this).val();a(this).is(":checked")?a('input[name="post[]"][value="'+c+'"]').prop("checked",!0):a('input[name="post[]"][value="'+c+'"]').prop("checked",!1)}),a(".wp-list-table.posts").on("click",".tribe-split",function(){var b="";return b=a(this).hasClass("tribe-split-all")?TribeEventsProAdmin.recurrence.splitAllMessage:TribeEventsProAdmin.recurrence.splitSingleMessage,window.confirm(b)?void 0:!1}),a(".wp-admin.events-cal.edit-php #doaction").click(function(b){"trash"==a("[name='action'] option:selected").val()&&a('.tribe-recurring-event-parent [name="post[]"]:checked').length>0&&!confirm(TribeEventsProAdmin.recurrence.bulkDeleteConfirmationMessage)&&b.preventDefault()}),"object"==typeof TribeEventsProRecurrenceUpdate){var p=a("div.tribe-events-recurring-update-msg"),q=p.find("img"),r=p.find("div.progress"),s=p.find("div.bar"),t=Date.now();setTimeout(k)}});